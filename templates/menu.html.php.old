<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><?= $title ?? 'DriveNow - Premium Car Rental Platform' ?></title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="base.css">
</head>
<body>

    <!-- ===== NAVBAR ===== -->
    <nav class="navbar" id="navbar">
        <div class="navbar-inner">
            <a href="index.php" class="navbar-brand">ğŸš— DriveNow</a>
            
            <ul class="navbar-nav" id="navMenu">
                <li><a href="#cars" class="active">Cars</a></li>
                <li><a href="#how-it-works">How It Works</a></li>
                <li><a href="#promotions">Promotions</a></li>
                <li><a href="#community">Community</a></li>
                <li><a href="#membership">Membership</a></li>
                <li><a href="#support">Support</a></li>
            </ul>

            <div class="navbar-actions">
                <button class="navbar-lang" onclick="toggleLanguageMenu()" id="langBtn">ğŸŒ EN</button>
                
                <?php if (isset($isLoggedIn) && $isLoggedIn): ?>
                    <button class="navbar-notification" onclick="toggleNotifications()" id="notifBtn">
                        ğŸ””
                        <span class="notification-badge" id="notifCount">3</span>
                    </button>
                    <span style="font-weight:600;font-size:0.875rem;color:var(--gray-700)">ğŸ‘¤ <?= htmlspecialchars($currentUser) ?></span>
                    <button class="btn btn-danger btn-sm" onclick="logout()">Logout</button>
                <?php else: ?>
                    <a href="login.php" class="btn btn-outline btn-sm">Sign In</a>
                    <a href="register.php" class="btn btn-primary btn-sm">Sign Up</a>
                <?php endif; ?>

                <button class="hamburger" onclick="toggleMobileMenu()" id="hamburger">
                    <span></span><span></span><span></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- ===== NOTIFICATION PANEL ===== -->
    <div class="notification-panel" id="notificationPanel">
        <div class="notification-panel-header">
            <span class="notification-panel-title">ğŸ”” Notifications</span>
            <button class="btn btn-ghost btn-sm" onclick="markAllRead()">Mark all read</button>
        </div>
        <ul class="notification-list" id="notificationList">
            <li class="notification-item unread">
                <div class="notification-icon booking">ğŸ“‹</div>
                <div class="notification-content">
                    <div class="notification-title">Booking Confirmed</div>
                    <div class="notification-text">Your Toyota Camry booking for March 5 has been confirmed.</div>
                    <div class="notification-time">2 minutes ago</div>
                </div>
            </li>
            <li class="notification-item unread">
                <div class="notification-icon payment">ğŸ’³</div>
                <div class="notification-content">
                    <div class="notification-title">Payment Received</div>
                    <div class="notification-text">$120.00 payment processed successfully.</div>
                    <div class="notification-time">1 hour ago</div>
                </div>
            </li>
            <li class="notification-item unread">
                <div class="notification-icon promo">ğŸ‰</div>
                <div class="notification-content">
                    <div class="notification-title">New Promotion!</div>
                    <div class="notification-text">Get 20% off on your next weekend rental. Code: WEEKEND20</div>
                    <div class="notification-time">3 hours ago</div>
                </div>
            </li>
            <li class="notification-item">
                <div class="notification-icon alert">ğŸ“§</div>
                <div class="notification-content">
                    <div class="notification-title">Email Confirmed</div>
                    <div class="notification-text">Your email address has been verified.</div>
                    <div class="notification-time">1 day ago</div>
                </div>
            </li>
        </ul>
    </div>

    <!-- ===== HERO SECTION ===== -->
    <section class="hero">
        <div class="hero-container">
            <div class="hero-content">
                <div class="hero-badge">âš¡ #1 Car Rental Platform Worldwide</div>
                <h1 class="hero-title">
                    Find Your Perfect <span>Drive</span> Today
                </h1>
                <p class="hero-description">
                    Book premium cars from trusted owners worldwide. Self-drive or with driver, online or by phone â€” your journey starts here.
                </p>
                <div style="display:flex;gap:12px;flex-wrap:wrap;">
                    <a href="#search-box" class="btn btn-primary btn-lg">ğŸ” Search Cars</a>
                    <a href="#how-it-works" class="btn btn-outline btn-lg" style="border-color:rgba(255,255,255,0.3);color:white;">Learn More â†’</a>
                </div>
                <div class="hero-stats">
                    <div class="hero-stat">
                        <div class="hero-stat-number">50K+</div>
                        <div class="hero-stat-label">Cars Available</div>
                    </div>
                    <div class="hero-stat">
                        <div class="hero-stat-number">120+</div>
                        <div class="hero-stat-label">Countries</div>
                    </div>
                    <div class="hero-stat">
                        <div class="hero-stat-number">2M+</div>
                        <div class="hero-stat-label">Happy Customers</div>
                    </div>
                    <div class="hero-stat">
                        <div class="hero-stat-number">4.9â˜…</div>
                        <div class="hero-stat-label">Average Rating</div>
                    </div>
                </div>
            </div>
            <div class="hero-image">
                <div class="hero-car-visual">ğŸï¸</div>
            </div>
        </div>
    </section>

    <!-- ===== SEARCH BOX ===== -->
    <div class="section-container">
        <div class="search-box" id="search-box">
            <div class="search-tabs">
                <button class="search-tab active" onclick="switchSearchTab(this, 'self-drive')">ğŸš— Self-Drive</button>
                <button class="search-tab" onclick="switchSearchTab(this, 'with-driver')">ğŸ‘¨â€âœˆï¸ With Driver</button>
                <button class="search-tab" onclick="switchSearchTab(this, 'airport')">âœˆï¸ Airport Transfer</button>
                <button class="search-tab" onclick="switchSearchTab(this, 'long-term')">ğŸ“‹ Long-term Contract</button>
            </div>
            <form class="search-form" onsubmit="handleSearch(event)">
                <div class="search-field">
                    <label>ğŸ“ Pick-up Location</label>
                    <input type="text" placeholder="City, airport, or address..." id="searchLocation">
                </div>
                <div class="search-field">
                    <label>ğŸ“… Pick-up Date</label>
                    <input type="datetime-local" id="searchPickup">
                </div>
                <div class="search-field">
                    <label>ğŸ“… Return Date</label>
                    <input type="datetime-local" id="searchReturn">
                </div>
                <div class="search-field">
                    <label>ğŸš˜ Vehicle Type</label>
                    <select id="searchType">
                        <option value="">All Types</option>
                        <option value="sedan">Sedan</option>
                        <option value="suv">SUV</option>
                        <option value="luxury">Luxury</option>
                        <option value="sports">Sports</option>
                        <option value="electric">Electric</option>
                        <option value="van">Van / Minibus</option>
                    </select>
                </div>
                <button type="submit" class="btn-search">ğŸ” Search</button>
            </form>
        </div>
    </div>

    <!-- ===== CAR CATEGORIES ===== -->
    <section class="section">
        <div class="section-container">
            <div class="section-header">
                <div>
                    <h2 class="section-title">Browse by Category</h2>
                    <p class="section-subtitle">Choose from a wide range of vehicle categories</p>
                </div>
                <a href="#" class="section-link">All Categories â†’</a>
            </div>
            <div class="category-grid">
                <div class="category-card" onclick="filterByCategory('sedan')">
                    <div class="category-icon">ğŸš—</div>
                    <div class="category-name">Sedan</div>
                    <div class="category-count">12,450 cars</div>
                </div>
                <div class="category-card" onclick="filterByCategory('suv')">
                    <div class="category-icon">ğŸš™</div>
                    <div class="category-name">SUV</div>
                    <div class="category-count">8,230 cars</div>
                </div>
                <div class="category-card" onclick="filterByCategory('luxury')">
                    <div class="category-icon">ğŸï¸</div>
                    <div class="category-name">Luxury</div>
                    <div class="category-count">3,120 cars</div>
                </div>
                <div class="category-card" onclick="filterByCategory('electric')">
                    <div class="category-icon">âš¡</div>
                    <div class="category-name">Electric</div>
                    <div class="category-count">5,670 cars</div>
                </div>
                <div class="category-card" onclick="filterByCategory('van')">
                    <div class="category-icon">ğŸš</div>
                    <div class="category-name">Van / Minibus</div>
                    <div class="category-count">2,890 cars</div>
                </div>
                <div class="category-card" onclick="filterByCategory('sports')">
                    <div class="category-icon">ğŸ</div>
                    <div class="category-name">Sports</div>
                    <div class="category-count">1,560 cars</div>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== FEATURED CARS ===== -->
    <section class="section featured-section" id="cars">
        <div class="section-container">
            <div class="section-header">
                <div>
                    <h2 class="section-title">â­ Featured Cars</h2>
                    <p class="section-subtitle">Handpicked premium vehicles with top ratings</p>
                </div>
                <a href="#" class="section-link">View All Cars â†’</a>
            </div>

            <!-- Filter System -->
            <div class="filter-section mb-4" id="filterSection">
                <div style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:24px;">
                    <div class="filter-group">
                        <div class="filter-group-title">Brand</div>
                        <div class="filter-options">
                            <button class="filter-chip active" onclick="toggleFilter(this)">All</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">Toyota</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">BMW</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">Mercedes</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">Tesla</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">Honda</button>
                        </div>
                    </div>
                    <div class="filter-group">
                        <div class="filter-group-title">Transmission</div>
                        <div class="filter-options">
                            <button class="filter-chip active" onclick="toggleFilter(this)">All</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">Automatic</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">Manual</button>
                        </div>
                    </div>
                    <div class="filter-group">
                        <div class="filter-group-title">Fuel Type</div>
                        <div class="filter-options">
                            <button class="filter-chip active" onclick="toggleFilter(this)">All</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">Petrol</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">Diesel</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">Electric</button>
                            <button class="filter-chip" onclick="toggleFilter(this)">Hybrid</button>
                        </div>
                    </div>
                    <div class="filter-group">
                        <div class="filter-group-title">Price Range ($/day)</div>
                        <div class="filter-range">
                            <input type="range" min="0" max="500" value="250" oninput="updatePriceFilter(this.value)">
                            <div class="filter-price-display">
                                <span>$0</span>
                                <span id="priceValue">$250</span>
                                <span>$500+</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="car-grid" id="carGrid">
                <!-- Car Card 1 -->
                <div class="car-card" onclick="openCarDetail('1')">
                    <div class="car-card-image">
                        ğŸš—
                        <div class="car-card-badge">
                            <span class="car-badge car-badge-featured">Featured</span>
                        </div>
                        <button class="car-card-favorite" onclick="event.stopPropagation();toggleFavorite(this)">ğŸ¤</button>
                    </div>
                    <div class="car-card-body">
                        <h3 class="car-card-title">Toyota Camry 2025</h3>
                        <p class="car-card-subtitle">Sedan â€¢ Automatic â€¢ Petrol</p>
                        <div class="car-card-features">
                            <span class="car-feature">ğŸ‘¤ 5 seats</span>
                            <span class="car-feature">â›½ 7L/100km</span>
                            <span class="car-feature">ğŸ“ GPS</span>
                            <span class="car-feature">â„ï¸ A/C</span>
                        </div>
                        <div class="car-card-footer">
                            <div class="car-card-price">
                                <span class="car-price-amount">$65</span>
                                <span class="car-price-unit">per day</span>
                            </div>
                            <div class="car-card-rating">
                                <span class="stars">â˜…â˜…â˜…â˜…â˜…</span>
                                <span class="count">(128)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Car Card 2 -->
                <div class="car-card" onclick="openCarDetail('2')">
                    <div class="car-card-image">
                        ğŸï¸
                        <div class="car-card-badge">
                            <span class="car-badge car-badge-promo">-20%</span>
                        </div>
                        <button class="car-card-favorite" onclick="event.stopPropagation();toggleFavorite(this)">ğŸ¤</button>
                    </div>
                    <div class="car-card-body">
                        <h3 class="car-card-title">BMW 3 Series 2025</h3>
                        <p class="car-card-subtitle">Luxury â€¢ Automatic â€¢ Petrol</p>
                        <div class="car-card-features">
                            <span class="car-feature">ğŸ‘¤ 5 seats</span>
                            <span class="car-feature">â›½ 6.5L/100km</span>
                            <span class="car-feature">ğŸ“ GPS</span>
                            <span class="car-feature">ğŸµ Premium</span>
                        </div>
                        <div class="car-card-footer">
                            <div class="car-card-price">
                                <span class="car-price-amount">$120</span>
                                <span class="car-price-unit">per day</span>
                            </div>
                            <div class="car-card-rating">
                                <span class="stars">â˜…â˜…â˜…â˜…â˜…</span>
                                <span class="count">(95)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Car Card 3 -->
                <div class="car-card" onclick="openCarDetail('3')">
                    <div class="car-card-image">
                        âš¡
                        <div class="car-card-badge">
                            <span class="car-badge car-badge-new">New</span>
                        </div>
                        <button class="car-card-favorite" onclick="event.stopPropagation();toggleFavorite(this)">ğŸ¤</button>
                    </div>
                    <div class="car-card-body">
                        <h3 class="car-card-title">Tesla Model 3 2025</h3>
                        <p class="car-card-subtitle">Electric â€¢ Automatic â€¢ EV</p>
                        <div class="car-card-features">
                            <span class="car-feature">ğŸ‘¤ 5 seats</span>
                            <span class="car-feature">ğŸ”‹ 358mi</span>
                            <span class="car-feature">ğŸ“ GPS</span>
                            <span class="car-feature">ğŸ¤– Autopilot</span>
                        </div>
                        <div class="car-card-footer">
                            <div class="car-card-price">
                                <span class="car-price-amount">$95</span>
                                <span class="car-price-unit">per day</span>
                            </div>
                            <div class="car-card-rating">
                                <span class="stars">â˜…â˜…â˜…â˜…â˜…</span>
                                <span class="count">(210)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Car Card 4 -->
                <div class="car-card" onclick="openCarDetail('4')">
                    <div class="car-card-image">
                        ğŸš™
                        <div class="car-card-badge">
                            <span class="car-badge car-badge-featured">Popular</span>
                        </div>
                        <button class="car-card-favorite" onclick="event.stopPropagation();toggleFavorite(this)">ğŸ¤</button>
                    </div>
                    <div class="car-card-body">
                        <h3 class="car-card-title">Mercedes GLC 2025</h3>
                        <p class="car-card-subtitle">SUV â€¢ Automatic â€¢ Diesel</p>
                        <div class="car-card-features">
                            <span class="car-feature">ğŸ‘¤ 5 seats</span>
                            <span class="car-feature">â›½ 8L/100km</span>
                            <span class="car-feature">ğŸ“ GPS</span>
                            <span class="car-feature">ğŸ”ï¸ 4WD</span>
                        </div>
                        <div class="car-card-footer">
                            <div class="car-card-price">
                                <span class="car-price-amount">$145</span>
                                <span class="car-price-unit">per day</span>
                            </div>
                            <div class="car-card-rating">
                                <span class="stars">â˜…â˜…â˜…â˜…â˜†</span>
                                <span class="count">(76)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== HOW IT WORKS ===== -->
    <section class="section" id="how-it-works">
        <div class="section-container">
            <div class="section-header">
                <div>
                    <h2 class="section-title">How It Works</h2>
                    <p class="section-subtitle">Rent a car in 4 simple steps â€” online or by phone</p>
                </div>
            </div>
            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <div class="step-icon">ğŸ”</div>
                    <h3 class="step-title">Search & Filter</h3>
                    <p class="step-description">Browse thousands of cars. Filter by type, price, location, brand, and more.</p>
                </div>
                <div class="step-card">
                    <div class="step-number">2</div>
                    <div class="step-icon">ğŸ“‹</div>
                    <h3 class="step-title">Book Online or Call</h3>
                    <p class="step-description">Book instantly online, via phone, or enquire with our customer service team.</p>
                </div>
                <div class="step-card">
                    <div class="step-number">3</div>
                    <div class="step-icon">ğŸ’³</div>
                    <h3 class="step-title">Pay Securely</h3>
                    <p class="step-description">Pay with cash, bank transfer, credit card, or digital wallet. All payments secured.</p>
                </div>
                <div class="step-card">
                    <div class="step-number">4</div>
                    <div class="step-icon">ğŸš—</div>
                    <h3 class="step-title">Pick Up & Drive</h3>
                    <p class="step-description">Pick up your car and enjoy your ride. GPS tracking available for car owners.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== PROMOTIONS ===== -->
    <section class="section" style="background:var(--gray-100);" id="promotions">
        <div class="section-container">
            <div class="section-header">
                <div>
                    <h2 class="section-title">ğŸ‰ Promotions & Deals</h2>
                    <p class="section-subtitle">Save big with our exclusive offers and promo codes</p>
                </div>
                <a href="#" class="section-link">All Promotions â†’</a>
            </div>
            <div class="promo-grid">
                <div class="promo-card" onclick="applyPromo('WEEKEND20')">
                    <div class="promo-discount">20% OFF</div>
                    <div class="promo-title">Weekend Special</div>
                    <div class="promo-description">Book any car for the weekend and save 20%. Valid until March 31.</div>
                    <div class="promo-code">WEEKEND20</div>
                </div>
                <div class="promo-card accent" onclick="applyPromo('FIRST50')">
                    <div class="promo-discount">$50 OFF</div>
                    <div class="promo-title">First Ride Bonus</div>
                    <div class="promo-description">New users get $50 off their first booking. Sign up today!</div>
                    <div class="promo-code">FIRST50</div>
                </div>
                <div class="promo-card dark" onclick="applyPromo('LONGTERM30')">
                    <div class="promo-discount">30% OFF</div>
                    <div class="promo-title">Long-term Rental</div>
                    <div class="promo-description">Book for 30+ days and get 30% discount. Perfect for corporate use.</div>
                    <div class="promo-code">LONGTERM30</div>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== GPS TRACKING (Car Owner Feature) ===== -->
    <section class="section">
        <div class="section-container">
            <div class="section-header">
                <div>
                    <h2 class="section-title">ğŸ“ GPS Car Tracking</h2>
                    <p class="section-subtitle">Real-time tracking for car owners â€” know where your car is, always</p>
                </div>
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:32px;align-items:center;">
                <div class="map-container">
                    <div class="map-placeholder">
                        <div class="map-placeholder-icon">ğŸ—ºï¸</div>
                        <p>Interactive GPS Map</p>
                        <p style="font-size:0.813rem;">Real-time car location tracking</p>
                        <button class="btn btn-primary btn-sm" onclick="showToast('GPS tracking requires an active rental booking.','info')">Enable Tracking</button>
                    </div>
                </div>
                <div>
                    <h3 style="font-size:1.5rem;font-weight:800;color:var(--gray-900);margin-bottom:16px;">Track Your Fleet in Real-Time</h3>
                    <p style="color:var(--gray-500);margin-bottom:24px;line-height:1.7;">
                        As a car owner, you get access to our advanced GPS tracking system. Monitor your vehicle's location, speed, and route history all from your dashboard.
                    </p>
                    <div style="display:flex;flex-direction:column;gap:12px;">
                        <div style="display:flex;align-items:center;gap:12px;">
                            <span style="width:40px;height:40px;border-radius:50%;background:var(--primary-50);display:flex;align-items:center;justify-content:center;">ğŸ“</span>
                            <div>
                                <strong>Live Location</strong>
                                <p style="font-size:0.813rem;color:var(--gray-500);">Track your car's position in real time</p>
                            </div>
                        </div>
                        <div style="display:flex;align-items:center;gap:12px;">
                            <span style="width:40px;height:40px;border-radius:50%;background:var(--success-light);display:flex;align-items:center;justify-content:center;">ğŸ›£ï¸</span>
                            <div>
                                <strong>Route History</strong>
                                <p style="font-size:0.813rem;color:var(--gray-500);">View complete trip history and routes</p>
                            </div>
                        </div>
                        <div style="display:flex;align-items:center;gap:12px;">
                            <span style="width:40px;height:40px;border-radius:50%;background:var(--warning-light);display:flex;align-items:center;justify-content:center;">ğŸ””</span>
                            <div>
                                <strong>Geo-fence Alerts</strong>
                                <p style="font-size:0.813rem;color:var(--gray-500);">Get notified when car leaves designated area</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== BOOKING SECTION ===== -->
    <section class="section" style="background:var(--gray-100);" id="booking">
        <div class="section-container">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:40px;">
                <div class="booking-form">
                    <h2 class="booking-form-title">ğŸ“‹ Book Your Ride</h2>
                    <p style="color:var(--gray-500);margin-bottom:24px;">Book online instantly or call us at <strong>+1 (800) DRIVE-NOW</strong></p>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-input" placeholder="John Doe" id="bookingName">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-input" placeholder="john@email.com" id="bookingEmail">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" class="form-input" placeholder="+1 (555) 000-0000" id="bookingPhone">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Booking Type</label>
                            <select class="form-select" id="bookingType">
                                <option value="self-drive">Self-Drive</option>
                                <option value="with-driver">With Driver</option>
                                <option value="airport">Airport Transfer</option>
                                <option value="corporate">Corporate / Long-term</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Pick-up Date & Time</label>
                            <input type="datetime-local" class="form-input" id="bookingPickup">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Return Date & Time</label>
                            <input type="datetime-local" class="form-input" id="bookingReturn">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Special Requests / Trip Enquiry</label>
                        <textarea class="form-textarea" placeholder="Any special requirements? Need a child seat? Ask about a specific trip..." id="bookingNotes"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Promo Code</label>
                        <div style="display:flex;gap:8px;">
                            <input type="text" class="form-input" placeholder="Enter promo code" id="bookingPromo">
                            <button class="btn btn-secondary" onclick="validatePromo()">Apply</button>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-lg btn-block" onclick="submitBooking()">
                        ğŸš— Confirm Booking
                    </button>
                    <p style="text-align:center;margin-top:12px;font-size:0.813rem;color:var(--gray-400);">
                        You can cancel or edit your booking up to 24 hours before pick-up.
                    </p>
                </div>

                <!-- Payment Methods -->
                <div>
                    <h2 style="font-size:1.5rem;font-weight:800;color:var(--gray-900);margin-bottom:16px;">ğŸ’³ Payment Options</h2>
                    <p style="color:var(--gray-500);margin-bottom:24px;line-height:1.7;">We accept all major payment methods. Choose what works best for you.</p>
                    
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:32px;">
                        <div class="payment-method active" onclick="selectPayment(this, 'cash')">
                            <span class="payment-method-icon">ğŸ’µ</span>
                            <span>Cash</span>
                        </div>
                        <div class="payment-method" onclick="selectPayment(this, 'transfer')">
                            <span class="payment-method-icon">ğŸ¦</span>
                            <span>Bank Transfer</span>
                        </div>
                        <div class="payment-method" onclick="selectPayment(this, 'card')">
                            <span class="payment-method-icon">ğŸ’³</span>
                            <span>Credit / Debit Card</span>
                        </div>
                        <div class="payment-method" onclick="selectPayment(this, 'paypal')">
                            <span class="payment-method-icon">ğŸ…¿ï¸</span>
                            <span>PayPal</span>
                        </div>
                        <div class="payment-method" onclick="selectPayment(this, 'apple')">
                            <span class="payment-method-icon">ğŸ</span>
                            <span>Apple Pay</span>
                        </div>
                        <div class="payment-method" onclick="selectPayment(this, 'google')">
                            <span class="payment-method-icon">ğŸ”µ</span>
                            <span>Google Pay</span>
                        </div>
                        <div class="payment-method" onclick="selectPayment(this, 'crypto')">
                            <span class="payment-method-icon">â‚¿</span>
                            <span>Cryptocurrency</span>
                        </div>
                        <div class="payment-method" onclick="selectPayment(this, 'wallet')">
                            <span class="payment-method-icon">ğŸ‘›</span>
                            <span>Digital Wallet</span>
                        </div>
                    </div>

                    <div style="background:var(--success-light);border-radius:var(--radius-md);padding:20px;margin-bottom:24px;">
                        <h4 style="color:var(--success);margin-bottom:8px;">ğŸ”’ Secure Payment Guarantee</h4>
                        <p style="font-size:0.875rem;color:var(--gray-600);line-height:1.6;">All transactions are encrypted with SSL. Your payment information is never stored on our servers.</p>
                    </div>

                    <div style="background:white;border-radius:var(--radius-md);padding:20px;border:1px solid var(--gray-200);">
                        <h4 style="margin-bottom:12px;color:var(--gray-800);">ğŸ“ Prefer to Book by Phone?</h4>
                        <p style="font-size:0.875rem;color:var(--gray-500);margin-bottom:12px;">Our team is available 24/7 to assist with bookings, enquiries, and special requests.</p>
                        <a href="tel:+18003748366" class="btn btn-primary">ğŸ“ Call +1 (800) DRIVE-NOW</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== MEMBERSHIP / SUBSCRIPTION ===== -->
    <section class="section" id="membership">
        <div class="section-container">
            <div class="section-header" style="justify-content:center;text-align:center;">
                <div>
                    <h2 class="section-title">ğŸ‘‘ Membership Plans</h2>
                    <p class="section-subtitle">Subscribe for exclusive benefits, discounts, and priority access</p>
                </div>
            </div>
            <div class="subscription-grid">
                <div class="subscription-card">
                    <h3 class="subscription-name">Basic</h3>
                    <div class="subscription-price">
                        <span class="amount">$9</span>
                        <span class="period">/month</span>
                    </div>
                    <ul class="subscription-features">
                        <li>5% discount on all rentals</li>
                        <li>Priority email support</li>
                        <li>Free cancellation (48h)</li>
                        <li>Monthly newsletter</li>
                        <li>Basic GPS tracking</li>
                    </ul>
                    <button class="btn btn-outline btn-block" onclick="subscribePlan('basic')">Choose Basic</button>
                </div>
                <div class="subscription-card popular">
                    <div class="subscription-popular-badge">Most Popular</div>
                    <h3 class="subscription-name">Premium</h3>
                    <div class="subscription-price">
                        <span class="amount">$29</span>
                        <span class="period">/month</span>
                    </div>
                    <ul class="subscription-features">
                        <li>15% discount on all rentals</li>
                        <li>24/7 priority support</li>
                        <li>Free cancellation (24h)</li>
                        <li>Free driver upgrade</li>
                        <li>Advanced GPS + route history</li>
                        <li>Airport lounge access</li>
                    </ul>
                    <button class="btn btn-primary btn-block" onclick="subscribePlan('premium')">Choose Premium</button>
                </div>
                <div class="subscription-card">
                    <h3 class="subscription-name">Corporate</h3>
                    <div class="subscription-price">
                        <span class="amount">$99</span>
                        <span class="period">/month</span>
                    </div>
                    <ul class="subscription-features">
                        <li>25% discount on all rentals</li>
                        <li>Dedicated account manager</li>
                        <li>Unlimited free cancellation</li>
                        <li>Fleet management dashboard</li>
                        <li>Custom billing & invoicing</li>
                        <li>Long-term contract rates</li>
                        <li>Multi-user accounts</li>
                    </ul>
                    <button class="btn btn-outline btn-block" onclick="subscribePlan('corporate')">Contact Sales</button>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== COMMUNITY ===== -->
    <section class="section" style="background:var(--gray-100);" id="community">
        <div class="section-container">
            <div class="section-header">
                <div>
                    <h2 class="section-title">ğŸŒ Community</h2>
                    <p class="section-subtitle">Share your road trip stories, tips, and experiences</p>
                </div>
                <button class="btn btn-primary" onclick="openPostModal()">âœï¸ Create Post</button>
            </div>
            <div class="community-grid">
                <div class="community-post">
                    <div class="community-post-image">ğŸ–ï¸</div>
                    <div class="community-post-body">
                        <div class="community-post-author">
                            <div class="community-avatar">ğŸ‘¤</div>
                            <div>
                                <div class="community-author-name">Sarah Johnson</div>
                                <div class="community-author-date">Feb 20, 2026</div>
                            </div>
                        </div>
                        <h3 class="community-post-title">Amazing Road Trip: LA to San Francisco</h3>
                        <p class="community-post-excerpt">Rented a Tesla Model 3 for a weekend trip along the Pacific Coast Highway. The autopilot made the drive so relaxing...</p>
                        <div class="community-post-actions">
                            <button class="community-action" onclick="likePost(this)">â¤ï¸ 42</button>
                            <button class="community-action">ğŸ’¬ 12</button>
                            <button class="community-action">ğŸ”— Share</button>
                        </div>
                    </div>
                </div>
                <div class="community-post">
                    <div class="community-post-image">ğŸ”ï¸</div>
                    <div class="community-post-body">
                        <div class="community-post-author">
                            <div class="community-avatar">ğŸ‘¤</div>
                            <div>
                                <div class="community-author-name">Mike Chen</div>
                                <div class="community-author-date">Feb 18, 2026</div>
                            </div>
                        </div>
                        <h3 class="community-post-title">Best SUVs for Mountain Adventures</h3>
                        <p class="community-post-excerpt">After trying 5 different SUVs on DriveNow, here's my honest review of each one for off-road adventures...</p>
                        <div class="community-post-actions">
                            <button class="community-action" onclick="likePost(this)">â¤ï¸ 89</button>
                            <button class="community-action">ğŸ’¬ 34</button>
                            <button class="community-action">ğŸ”— Share</button>
                        </div>
                    </div>
                </div>
                <div class="community-post">
                    <div class="community-post-image">ğŸŒ†</div>
                    <div class="community-post-body">
                        <div class="community-post-author">
                            <div class="community-avatar">ğŸ‘¤</div>
                            <div>
                                <div class="community-author-name">Emma Wilson</div>
                                <div class="community-author-date">Feb 15, 2026</div>
                            </div>
                        </div>
                        <h3 class="community-post-title">Corporate Fleet Experience: 6 Month Review</h3>
                        <p class="community-post-excerpt">Our company switched to DriveNow for our corporate fleet needs. Here's how it's been going after 6 months...</p>
                        <div class="community-post-actions">
                            <button class="community-action" onclick="likePost(this)">â¤ï¸ 156</button>
                            <button class="community-action">ğŸ’¬ 48</button>
                            <button class="community-action">ğŸ”— Share</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== REVIEWS & RATINGS ===== -->
    <section class="section">
        <div class="section-container">
            <div class="section-header">
                <div>
                    <h2 class="section-title">â­ Customer Reviews</h2>
                    <p class="section-subtitle">See what our customers are saying about their experience</p>
                </div>
                <button class="btn btn-outline btn-sm" onclick="openReviewModal()">Write a Review</button>
            </div>
            <div class="review-grid">
                <div class="review-card">
                    <div class="review-stars">â˜…â˜…â˜…â˜…â˜…</div>
                    <p class="review-text">"Best car rental experience ever! The booking process was seamless, and the car was in perfect condition. Will definitely use DriveNow again."</p>
                    <div class="review-author">
                        <div class="review-avatar">JD</div>
                        <div class="review-author-info">
                            <div class="review-author-name">James Davis</div>
                            <div class="review-author-trip">BMW 5 Series â€¢ New York â†’ Boston</div>
                        </div>
                    </div>
                </div>
                <div class="review-card">
                    <div class="review-stars">â˜…â˜…â˜…â˜…â˜…</div>
                    <p class="review-text">"The face recognition login is super cool! No passwords to remember. And the AI chatbot helped me find the perfect car for my family trip."</p>
                    <div class="review-author">
                        <div class="review-avatar">AL</div>
                        <div class="review-author-info">
                            <div class="review-author-name">Anna Lee</div>
                            <div class="review-author-trip">Honda CR-V â€¢ Tokyo â†’ Osaka</div>
                        </div>
                    </div>
                </div>
                <div class="review-card">
                    <div class="review-stars">â˜…â˜…â˜…â˜…â˜†</div>
                    <p class="review-text">"Great selection of electric vehicles. The GPS tracking feature gave me peace of mind when renting out my car. Very professional platform."</p>
                    <div class="review-author">
                        <div class="review-avatar">MP</div>
                        <div class="review-author-info">
                            <div class="review-author-name">Marco Polo</div>
                            <div class="review-author-trip">Tesla Model Y â€¢ Milan â†’ Rome</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== CUSTOMER SUPPORT ===== -->
    <section class="section" style="background:var(--gray-100);" id="support">
        <div class="section-container">
            <div class="section-header" style="justify-content:center;text-align:center;">
                <div>
                    <h2 class="section-title">ğŸ›¡ï¸ Customer Support</h2>
                    <p class="section-subtitle">We're here to help 24/7 â€” reach us anytime, anywhere</p>
                </div>
            </div>
            <div class="support-grid">
                <div class="support-card" onclick="openChatbot()">
                    <div class="support-icon">ğŸ¤–</div>
                    <h3 class="support-title">AI Chatbot</h3>
                    <p class="support-description">Get instant answers to your questions with our intelligent AI assistant.</p>
                </div>
                <div class="support-card" onclick="window.open('tel:+18003748366')">
                    <div class="support-icon">ğŸ“</div>
                    <h3 class="support-title">Phone Support</h3>
                    <p class="support-description">Call us 24/7 at +1 (800) DRIVE-NOW for immediate assistance.</p>
                </div>
                <div class="support-card" onclick="window.open('mailto:support@drivenow.com')">
                    <div class="support-icon">ğŸ“§</div>
                    <h3 class="support-title">Email Support</h3>
                    <p class="support-description">Send us an email and we'll respond within 2 hours.</p>
                </div>
                <div class="support-card" onclick="openEnquiryModal()">
                    <div class="support-icon">ğŸ“‹</div>
                    <h3 class="support-title">Trip Enquiry</h3>
                    <p class="support-description">Need a custom trip? Submit an enquiry and we'll plan it for you.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== FOOTER ===== -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-grid">
                <div>
                    <div class="footer-brand">ğŸš— DriveNow</div>
                    <p class="footer-description">
                        The world's leading car rental platform. Book premium cars from trusted owners in 120+ countries. Self-drive or with driver.
                    </p>
                    <div class="social-links">
                        <a href="#" class="social-link" title="Facebook">ğŸ“˜</a>
                        <a href="#" class="social-link" title="Twitter/X">ğŸ¦</a>
                        <a href="#" class="social-link" title="Instagram">ğŸ“¸</a>
                        <a href="#" class="social-link" title="YouTube">ğŸ¬</a>
                        <a href="#" class="social-link" title="TikTok">ğŸµ</a>
                        <a href="#" class="social-link" title="LinkedIn">ğŸ’¼</a>
                    </div>
                </div>
                <div>
                    <h4 class="footer-title">Company</h4>
                    <ul class="footer-links">
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">Careers</a></li>
                        <li><a href="#">Blog</a></li>
                        <li><a href="#">Press</a></li>
                        <li><a href="#">Partners</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="footer-title">Services</h4>
                    <ul class="footer-links">
                        <li><a href="#">Self-Drive Rental</a></li>
                        <li><a href="#">Book a Driver</a></li>
                        <li><a href="#">Airport Transfer</a></li>
                        <li><a href="#">Corporate Fleet</a></li>
                        <li><a href="#">Long-term Rental</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="footer-title">Support</h4>
                    <ul class="footer-links">
                        <li><a href="#">Help Center</a></li>
                        <li><a href="#">Contact Us</a></li>
                        <li><a href="#">Trip Enquiry</a></li>
                        <li><a href="#">Cancellation Policy</a></li>
                        <li><a href="#">Insurance</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="footer-title">Download App</h4>
                    <div class="footer-devices" style="flex-direction:column;">
                        <a href="#" class="footer-device-badge">ğŸ App Store</a>
                        <a href="#" class="footer-device-badge">ğŸ¤– Google Play</a>
                        <a href="#" class="footer-device-badge">ğŸ–¥ï¸ Web App</a>
                    </div>
                    <h4 class="footer-title" style="margin-top:24px;">Supported Devices</h4>
                    <p style="font-size:0.813rem;color:var(--gray-400);">iOS, Android, Web Browser, Desktop, Tablet â€” all devices supported.</p>
                </div>
            </div>
            <div class="footer-bottom">
                <span>Â© 2026 DriveNow. All rights reserved. Available in 120+ countries worldwide.</span>
                <div style="display:flex;gap:16px;">
                    <a href="#" style="color:var(--gray-400);transition:var(--transition);">Privacy</a>
                    <a href="#" style="color:var(--gray-400);">Terms</a>
                    <a href="#" style="color:var(--gray-400);">Cookies</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- ===== AI CHATBOT WIDGET ===== -->
    <div class="chatbot-widget" id="chatbotWidget">
        <div class="chatbot-window" id="chatbotWindow">
            <div class="chatbot-header">
                <div class="chatbot-header-info">
                    <div class="chatbot-header-avatar">ğŸ¤–</div>
                    <div>
                        <div class="chatbot-header-name">DriveNow AI Assistant</div>
                        <div class="chatbot-header-status">â— Online â€” powered by AI + Memory</div>
                    </div>
                </div>
                <button class="chatbot-close" onclick="toggleChatbot()">âœ•</button>
            </div>
            <div class="chatbot-messages" id="chatMessages">
                <div class="chat-message bot">
                    <div class="chat-bubble">
                        ğŸ‘‹ Hi there! I'm your DriveNow AI assistant. I can help you with:<br><br>
                        ğŸ” Finding the perfect car<br>
                        ğŸ“‹ Booking assistance<br>
                        ğŸ’³ Payment questions<br>
                        ğŸ—ºï¸ Trip recommendations<br><br>
                        How can I help you today?
                    </div>
                </div>
                <div class="chatbot-typing" id="typingIndicator">
                    <span></span><span></span><span></span>
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatInput" placeholder="Type your message..." onkeypress="if(event.key==='Enter')sendChatMessage()">
                <button onclick="sendChatMessage()">â¤</button>
            </div>
        </div>
        <button class="chatbot-toggle" onclick="toggleChatbot()" id="chatbotToggle">ğŸ’¬</button>
    </div>

    <!-- ===== BOOKING MODAL ===== -->
    <div class="modal-overlay" id="carDetailModal">
        <div class="modal" style="max-width:640px;">
            <div class="modal-header">
                <h3 class="modal-title" id="modalCarTitle">Car Details</h3>
                <button class="modal-close" onclick="closeModal('carDetailModal')">âœ•</button>
            </div>
            <div class="modal-body" id="modalCarBody">
                <div style="text-align:center;font-size:6rem;padding:32px;background:var(--gray-50);border-radius:var(--radius-md);margin-bottom:24px;" id="modalCarImage">ğŸš—</div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:24px;" id="modalCarSpecs">
                    <div style="padding:12px;background:var(--gray-50);border-radius:var(--radius);text-align:center;">
                        <div style="font-size:0.75rem;color:var(--gray-500);">Seats</div>
                        <div style="font-weight:700;">5</div>
                    </div>
                    <div style="padding:12px;background:var(--gray-50);border-radius:var(--radius);text-align:center;">
                        <div style="font-size:0.75rem;color:var(--gray-500);">Transmission</div>
                        <div style="font-weight:700;">Automatic</div>
                    </div>
                    <div style="padding:12px;background:var(--gray-50);border-radius:var(--radius);text-align:center;">
                        <div style="font-size:0.75rem;color:var(--gray-500);">Fuel</div>
                        <div style="font-weight:700;">Petrol</div>
                    </div>
                    <div style="padding:12px;background:var(--gray-50);border-radius:var(--radius);text-align:center;">
                        <div style="font-size:0.75rem;color:var(--gray-500);">GPS</div>
                        <div style="font-weight:700;">Included</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('carDetailModal')">Close</button>
                <button class="btn btn-primary" onclick="closeModal('carDetailModal');document.getElementById('booking').scrollIntoView({behavior:'smooth'})">Book This Car</button>
            </div>
        </div>
    </div>

    <!-- ===== ENQUIRY MODAL ===== -->
    <div class="modal-overlay" id="enquiryModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ“‹ Trip Enquiry</h3>
                <button class="modal-close" onclick="closeModal('enquiryModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Your Name</label>
                    <input type="text" class="form-input" placeholder="Full name">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Trip Details</label>
                    <textarea class="form-textarea" placeholder="Describe your trip: destination, dates, number of passengers, special requirements..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Preferred Contact Method</label>
                    <select class="form-select">
                        <option>Email</option>
                        <option>Phone Call</option>
                        <option>WhatsApp</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('enquiryModal')">Cancel</button>
                <button class="btn btn-primary" onclick="submitEnquiry()">Submit Enquiry</button>
            </div>
        </div>
    </div>

    <!-- ===== POST MODAL ===== -->
    <div class="modal-overlay" id="postModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">âœï¸ Create Community Post</h3>
                <button class="modal-close" onclick="closeModal('postModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Post Title</label>
                    <input type="text" class="form-input" placeholder="Give your post a great title...">
                </div>
                <div class="form-group">
                    <label class="form-label">Content</label>
                    <textarea class="form-textarea" style="min-height:150px;" placeholder="Share your experience, tips, or review..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select class="form-select">
                        <option>Road Trip Story</option>
                        <option>Car Review</option>
                        <option>Tips & Advice</option>
                        <option>Question</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('postModal')">Cancel</button>
                <button class="btn btn-primary" onclick="submitPost()">Publish Post</button>
            </div>
        </div>
    </div>

    <!-- ===== REVIEW MODAL ===== -->
    <div class="modal-overlay" id="reviewModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">â­ Write a Review</h3>
                <button class="modal-close" onclick="closeModal('reviewModal')">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Rating</label>
                    <div style="font-size:2rem;cursor:pointer;" id="ratingStars" onclick="setRating(event)">â˜†â˜†â˜†â˜†â˜†</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Car Rented</label>
                    <input type="text" class="form-input" placeholder="e.g., Toyota Camry 2025">
                </div>
                <div class="form-group">
                    <label class="form-label">Your Review</label>
                    <textarea class="form-textarea" placeholder="Tell us about your experience..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('reviewModal')">Cancel</button>
                <button class="btn btn-primary" onclick="submitReview()">Submit Review</button>
            </div>
        </div>
    </div>

    <!-- ===== TOAST CONTAINER ===== -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- ===== JAVASCRIPT ===== -->
    <script>
        // ===== CONFIGURATION =====
        const N8N_WEBHOOK_URL = '<?= \EnvLoader::get("N8N_WEBHOOK_URL", "http://localhost:5678/webhook/83eb33b2-fde3-4aa6-aa37-c3da8c1ca60f") ?>';
        const CHATBOT_API_URL = 'chatbot-with-memory.php';

        // ===== NAVBAR =====
        window.addEventListener('scroll', () => {
            document.getElementById('navbar').classList.toggle('scrolled', window.scrollY > 10);
        });

        function toggleMobileMenu() {
            document.getElementById('navMenu').classList.toggle('mobile-open');
        }

        // ===== NOTIFICATIONS =====
        function toggleNotifications() {
            document.getElementById('notificationPanel').classList.toggle('open');
        }

        function markAllRead() {
            document.querySelectorAll('.notification-item.unread').forEach(item => {
                item.classList.remove('unread');
            });
            document.getElementById('notifCount').textContent = '0';
            showToast('All notifications marked as read.', 'success');
        }

        // Close notification panel when clicking outside
        document.addEventListener('click', (e) => {
            const panel = document.getElementById('notificationPanel');
            const btn = document.getElementById('notifBtn');
            if (panel && btn && !panel.contains(e.target) && !btn.contains(e.target)) {
                panel.classList.remove('open');
            }
        });

        // ===== LANGUAGE =====
        const languages = ['EN', 'VI', 'FR', 'DE', 'ES', 'JP', 'KR', 'ZH'];
        let currentLangIndex = 0;
        function toggleLanguageMenu() {
            currentLangIndex = (currentLangIndex + 1) % languages.length;
            document.getElementById('langBtn').textContent = 'ğŸŒ ' + languages[currentLangIndex];
            showToast('Language switched to ' + languages[currentLangIndex], 'info');
        }

        // ===== SEARCH =====
        function switchSearchTab(tab, type) {
            document.querySelectorAll('.search-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
        }

        function handleSearch(e) {
            e.preventDefault();
            const location = document.getElementById('searchLocation').value;
            const pickup = document.getElementById('searchPickup').value;
            const returnDate = document.getElementById('searchReturn').value;
            const type = document.getElementById('searchType').value;

            if (!location) {
                showToast('Please enter a pick-up location.', 'warning');
                return;
            }

            showToast('Searching for cars in "' + location + '"...', 'info');
            document.getElementById('cars').scrollIntoView({ behavior: 'smooth' });
        }

        // ===== FILTERS =====
        function toggleFilter(chip) {
            const group = chip.parentElement;
            group.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
            chip.classList.add('active');
            showToast('Filter applied: ' + chip.textContent, 'info');
        }

        function updatePriceFilter(value) {
            document.getElementById('priceValue').textContent = '$' + value;
        }

        function filterByCategory(category) {
            showToast('Showing ' + category + ' cars...', 'info');
            document.getElementById('cars').scrollIntoView({ behavior: 'smooth' });
        }

        // ===== FAVORITES =====
        function toggleFavorite(btn) {
            btn.classList.toggle('active');
            btn.textContent = btn.classList.contains('active') ? 'â¤ï¸' : 'ğŸ¤';
            showToast(btn.classList.contains('active') ? 'Added to favorites!' : 'Removed from favorites.', 'success');
        }

        // ===== CAR DETAILS =====
        const carData = {
            '1': { title: 'Toyota Camry 2025', emoji: 'ğŸš—', seats: '5', transmission: 'Automatic', fuel: 'Petrol', price: '$65/day' },
            '2': { title: 'BMW 3 Series 2025', emoji: 'ğŸï¸', seats: '5', transmission: 'Automatic', fuel: 'Petrol', price: '$120/day' },
            '3': { title: 'Tesla Model 3 2025', emoji: 'âš¡', seats: '5', transmission: 'Automatic', fuel: 'Electric', price: '$95/day' },
            '4': { title: 'Mercedes GLC 2025', emoji: 'ğŸš™', seats: '5', transmission: 'Automatic', fuel: 'Diesel', price: '$145/day' },
        };

        function openCarDetail(id) {
            const car = carData[id];
            if (!car) return;
            document.getElementById('modalCarTitle').textContent = car.title;
            document.getElementById('modalCarImage').textContent = car.emoji;
            document.getElementById('carDetailModal').classList.add('open');
        }

        // ===== MODALS =====
        function closeModal(id) {
            document.getElementById(id).classList.remove('open');
        }

        function openEnquiryModal() {
            document.getElementById('enquiryModal').classList.add('open');
        }

        function openPostModal() {
            document.getElementById('postModal').classList.add('open');
        }

        function openReviewModal() {
            document.getElementById('reviewModal').classList.add('open');
        }

        // Close modals on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) overlay.classList.remove('open');
            });
        });

        // ===== BOOKING =====
        function submitBooking() {
            const name = document.getElementById('bookingName').value;
            const email = document.getElementById('bookingEmail').value;

            if (!name || !email) {
                showToast('Please fill in your name and email.', 'warning');
                return;
            }

            showToast('ğŸ‰ Booking submitted! Confirmation email will be sent to ' + email, 'success');
            
            // Send confirmation notification
            addNotification('Booking Submitted', 'Your booking has been submitted. Check your email for confirmation.', 'booking');
        }

        function validatePromo() {
            const code = document.getElementById('bookingPromo').value.toUpperCase();
            const validCodes = { 'WEEKEND20': '20% off weekends!', 'FIRST50': '$50 off first booking!', 'LONGTERM30': '30% off 30+ day rentals!' };

            if (validCodes[code]) {
                showToast('âœ… Promo code applied: ' + validCodes[code], 'success');
            } else {
                showToast('âŒ Invalid promo code.', 'error');
            }
        }

        // ===== PAYMENT =====
        function selectPayment(el, method) {
            document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('active'));
            el.classList.add('active');
        }

        // ===== PROMOTIONS =====
        function applyPromo(code) {
            document.getElementById('bookingPromo').value = code;
            showToast('Promo code "' + code + '" copied! Apply it during booking.', 'success');
            document.getElementById('booking').scrollIntoView({ behavior: 'smooth' });
        }

        // ===== SUBSCRIPTION =====
        function subscribePlan(plan) {
            if (plan === 'corporate') {
                openEnquiryModal();
            } else {
                showToast('ğŸ‰ Redirecting to ' + plan + ' subscription checkout...', 'info');
            }
        }

        // ===== COMMUNITY =====
        function likePost(btn) {
            const text = btn.textContent;
            const count = parseInt(text.match(/\d+/)[0]) + 1;
            btn.textContent = 'â¤ï¸ ' + count;
            btn.style.color = 'var(--danger)';
        }

        function submitPost() {
            closeModal('postModal');
            showToast('âœ… Your post has been published!', 'success');
        }

        function submitEnquiry() {
            closeModal('enquiryModal');
            showToast('âœ… Trip enquiry submitted! Our team will contact you within 2 hours.', 'success');
        }

        function submitReview() {
            closeModal('reviewModal');
            showToast('âœ… Thank you for your review!', 'success');
        }

        function setRating(event) {
            const stars = document.getElementById('ratingStars');
            const rect = stars.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const rating = Math.ceil((x / rect.width) * 5);
            stars.textContent = 'â˜…'.repeat(rating) + 'â˜†'.repeat(5 - rating);
        }

        // ===== CHATBOT =====
        function toggleChatbot() {
            const window = document.getElementById('chatbotWindow');
            window.classList.toggle('open');
            document.getElementById('chatbotToggle').textContent = window.classList.contains('open') ? 'âœ•' : 'ğŸ’¬';
        }

        function openChatbot() {
            const window = document.getElementById('chatbotWindow');
            if (!window.classList.contains('open')) toggleChatbot();
        }

        function addChatMessage(text, isUser = false) {
            const messagesDiv = document.getElementById('chatMessages');
            const typing = document.getElementById('typingIndicator');
            
            const msgDiv = document.createElement('div');
            msgDiv.className = 'chat-message ' + (isUser ? 'user' : 'bot');
            msgDiv.innerHTML = '<div class="chat-bubble">' + text + '</div>';
            
            messagesDiv.insertBefore(msgDiv, typing);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function showChatTyping(show) {
            document.getElementById('typingIndicator').classList.toggle('active', show);
            if (show) {
                document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
            }
        }

        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;

            addChatMessage(message, true);
            input.value = '';
            showChatTyping(true);

            try {
                const response = await fetch(CHATBOT_API_URL, {
                    method: 'POST',
                    mode: 'cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: message,
                        chatInput: message,
                        prompt: message,
                        timestamp: new Date().toISOString()
                    })
                });

                const responseText = await response.text();
                showChatTyping(false);

                if (!responseText || responseText.trim() === '') {
                    addChatMessage('âœ… Message received! Processing your request...');
                    return;
                }

                try {
                    const data = JSON.parse(responseText);
                    if (data.success) {
                        addChatMessage(data.response);
                        if (data.context_used) {
                            console.log('ğŸ’¾ Memory context was used to improve response');
                        }
                    } else {
                        addChatMessage('âŒ ' + (data.message || 'Something went wrong. Please try again.'));
                    }
                } catch (e) {
                    addChatMessage(responseText);
                }
            } catch (error) {
                showChatTyping(false);
                addChatMessage('âš ï¸ Connection error. Please check if the server is running.');
                console.error('Chat error:', error);
            }
        }

        // ===== TOAST NOTIFICATIONS =====
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const icons = { success: 'âœ…', error: 'âŒ', warning: 'âš ï¸', info: 'â„¹ï¸' };
            
            const toast = document.createElement('div');
            toast.className = 'toast toast-' + type;
            toast.innerHTML = `
                <span class="toast-icon">${icons[type] || 'â„¹ï¸'}</span>
                <span class="toast-message">${message}</span>
                <button class="toast-close" onclick="this.parentElement.remove()">âœ•</button>
            `;
            
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 5000);
        }

        // ===== ADD NOTIFICATION =====
        function addNotification(title, text, type = 'booking') {
            const list = document.getElementById('notificationList');
            const icons = { booking: 'ğŸ“‹', payment: 'ğŸ’³', alert: 'ğŸ””', promo: 'ğŸ‰' };
            
            const item = document.createElement('li');
            item.className = 'notification-item unread';
            item.innerHTML = `
                <div class="notification-icon ${type}">${icons[type] || 'ğŸ””'}</div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-text">${text}</div>
                    <div class="notification-time">Just now</div>
                </div>
            `;
            
            list.insertBefore(item, list.firstChild);
            
            const badge = document.getElementById('notifCount');
            if (badge) badge.textContent = parseInt(badge.textContent || 0) + 1;
        }

        // ===== AUTH =====
        async function logout() {
            try {
                await fetch('face-api.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'logout' })
                });
                window.location.reload();
            } catch (error) {
                console.error('Logout error:', error);
            }
        }

        // ===== SMOOTH SCROLL FOR NAV =====
        document.querySelectorAll('.navbar-nav a').forEach(link => {
            link.addEventListener('click', (e) => {
                const href = link.getAttribute('href');
                if (href.startsWith('#')) {
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        // Close mobile menu
                        document.getElementById('navMenu').classList.remove('mobile-open');
                    }
                }
            });
        });

        // ===== INIT =====
        console.log('ğŸš— DriveNow Platform loaded successfully!');
    </script>
</body>
</html>